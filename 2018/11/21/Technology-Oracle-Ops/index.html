<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Oracle 数据库日常维护 | Ribose Yim&#39;s Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要 【编辑中】 init params files tree">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle 数据库日常维护">
<meta property="og:url" content="https://riboseyim.com/2018/11/21/Technology-Oracle-Ops/index.html">
<meta property="og:site_name" content="Ribose Yim&#39;s Home">
<meta property="og:description" content="摘要 【编辑中】 init params files tree">
<meta property="og:locale">
<meta property="article:published_time" content="2018-11-21T06:03:16.000Z">
<meta property="article:modified_time" content="2023-08-16T02:50:10.000Z">
<meta property="article:author" content="RiboseYim">
<meta property="article:tag" content="DevOps">
<meta property="article:tag" content="Database">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Ribose Yim&#39;s Home" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-129742531-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://riboseyim.com"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/tags/DevOps">DevOps</a>
        
          <a class="main-nav-link" href="/tags/Machine-Learning">机器学习</a>
        
          <a class="main-nav-link" href="/tags/Economist">经济学人</a>
        
          <a class="main-nav-link" href="/tags/Policy-Law">Policy&amp;Law</a>
        
          <a class="main-nav-link" href="/charts">图表</a>
        
          <a class="main-nav-link" href="/2017/02/09/eBook">电子书</a>
        
          <a class="main-nav-link" href="/2016/05/31/AboutMe">关于</a>
        
          <a class="main-nav-link" href="https://riboseyim.com">TechBlog</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Ribose Yim&#39;s Home</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Technology-Oracle-Ops" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/21/Technology-Oracle-Ops/" class="article-date">
  <time datetime="2018-11-21T06:03:16.000Z" itemprop="datePublished">2018-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/technology/">工程技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Oracle 数据库日常维护
    </h1>
  

      </header>
      
      <footer class="article-footer">
        <a data-url="https://riboseyim.com/2018/11/21/Technology-Oracle-Ops/" data-id="ckwgm33p8013l7b1y6k7xuxch" class="article-share-link">分享</a>
        
        
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Database/" rel="tag">Database</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/" rel="tag">DevOps</a></li></ul>

      </footer>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><ul>
<li>【编辑中】</li>
<li>init params</li>
<li>files tree</li>
</ul>
<span id="more"></span>
<h2 id="INSTALL"><a href="#INSTALL" class="headerlink" title="INSTALL"></a>INSTALL</h2><h4 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span><span class="operator">&gt;</span><span class="keyword">alter</span> <span class="keyword">user</span> USER_NAME identified <span class="keyword">by</span> USER_PASSWD;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看用户的proifle，默认：default</span></span><br><span class="line"><span class="keyword">sql</span><span class="operator">&gt;</span><span class="keyword">SELECT</span> username,PROFILE <span class="keyword">FROM</span> dba_users <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">sql</span><span class="operator">&gt;</span><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dba_profiles s <span class="keyword">WHERE</span> s.profile<span class="operator">=</span><span class="string">&#x27;DEFAULT&#x27;</span> <span class="keyword">AND</span> resource_name<span class="operator">=</span><span class="string">&#x27;PASSWORD_LIFE_TIME&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">sql</span><span class="operator">&gt;</span><span class="keyword">ALTER</span> PROFILE <span class="keyword">DEFAULT</span> LIMIT PASSWORD_LIFE_TIME UNLIMITED;</span><br><span class="line"><span class="keyword">sql</span><span class="operator">&gt;</span><span class="keyword">ALTER</span> PROFILE <span class="keyword">DEFAULT</span> LIMIT PASSWORD_LIFE_TIME <span class="number">90</span>;</span><br></pre></td></tr></table></figure>
<h4 id="Init-Params"><a href="#Init-Params" class="headerlink" title="Init Params"></a>Init Params</h4><ul>
<li><p>初始化参数文件（Initialization Parameters Files,pfile）<br>pfile 默认为“init+例程名.ora”,文本文件，可以手工编辑。</p>
</li>
<li><p>spfile:服务器参数文件（Server Parameter Files）<br>spfile 默认为“spfile+例程名.ora”，<strong>不能用vi编辑器对其中参数进行修改，只能通过命令在线修改。</strong></p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- $ORACLE_HOME/dbs/spfiledbnms.ora</span></span><br><span class="line"><span class="comment">--pfile格式转换：将二进制转换为文本格式</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> Spfile <span class="keyword">FROM</span> pfile;</span><br><span class="line">这种方法，然后再用vi编辑器对其中的参数进行直观修改，以达到方便的目的。</span><br><span class="line"></span><br><span class="line"><span class="comment">--pfile格式转换：将文本转为二进制格式</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> pfile <span class="keyword">FROM</span> Spfile;</span><br><span class="line"></span><br><span class="line"># df <span class="operator">-</span>k <span class="operator">/</span>dev<span class="operator">/</span>shm</span><br><span class="line">Filesystem     <span class="number">1</span>K<span class="operator">-</span>blocks  Used Available Use<span class="operator">%</span> Mounted <span class="keyword">on</span></span><br><span class="line">tmpfs            <span class="number">4194304</span>   <span class="number">288</span>   <span class="number">4194016</span>   <span class="number">1</span><span class="operator">%</span> <span class="operator">/</span>dev<span class="operator">/</span>shm</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/cd/B19306_01/server.102/b14237/initparams193.htm#REFRN10256">SGA</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/cd/B19306_01/server.102/b14237/initparams157.htm#REFRN10165">pga_aggregate_target</a></li>
</ul>
<p>SGA_TARGET specifies the total size of all SGA components.<br>If SGA_TARGET is specified, then the following memory pools are automatically sized:</p>
<ul>
<li>Buffer cache (DB_CACHE_SIZE)</li>
<li>Shared pool (SHARED_POOL_SIZE)</li>
<li>Large pool (LARGE_POOL_SIZE)</li>
<li>Java pool (JAVA_POOL_SIZE)</li>
<li>Streams pool (STREAMS_POOL_SIZE)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pga_aggregate_target = total memory - SGA</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>When setting this parameter, you should examine the total memory on your system that is available to the Oracle instance and subtract the SGA. You can assign the remaining memory to PGA_AGGREGATE_TARGET.</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># example:vi $ORACLE_HOME/dbs/spfiledbnms.ora</span></span><br><span class="line"><span class="comment"># dbnms.__java_pool_size=939524096</span></span><br><span class="line"><span class="comment"># dbnms.__large_pool_size=805306368</span></span><br><span class="line">dbnms.__java_pool_size=<span class="number">4294967296</span></span><br><span class="line">dbnms.__large_pool_size=<span class="number">4294967296</span></span><br><span class="line">dbnms.__oracle_base=<span class="string">&#x27;/oracle/product&#x27;</span><span class="comment">#ORACLE_BASE set from environment</span></span><br><span class="line"><span class="comment">#dbnms.__pga_aggregate_target=16106127360</span></span><br><span class="line">dbnms.__pga_aggregate_target=<span class="number">0</span></span><br><span class="line"><span class="comment">#dbnms.__sga_target=64424509440</span></span><br><span class="line">dbnms.sga_target=<span class="number">4294967296</span></span><br><span class="line">dbnms.__shared_io_pool_size=<span class="number">0</span></span><br><span class="line">dbnms.__shared_pool_size=<span class="number">4697620480</span></span><br><span class="line">dbnms.__streams_pool_size=<span class="number">0</span></span><br><span class="line">*.audit_file_dest=<span class="string">&#x27;/oracle/product/admin/dbnms/adump&#x27;</span></span><br><span class="line">*.audit_trail=<span class="string">&#x27;db&#x27;</span></span><br><span class="line">*.compatible=<span class="string">&#x27;11.2.0.4.0&#x27;</span></span><br><span class="line">*.control_files=<span class="string">&#x27;/oradata1/dbnms/control01.ctl&#x27;</span>,<span class="string">&#x27;/oradata2/dbnms/control02.ctl&#x27;</span></span><br><span class="line">*.db_block_size=<span class="number">8192</span></span><br><span class="line">*.db_domain=<span class="string">&#x27;&#x27;</span></span><br><span class="line">*.db_name=<span class="string">&#x27;dbnms&#x27;</span></span><br><span class="line">*.diagnostic_dest=<span class="string">&#x27;/oracle/product&#x27;</span></span><br><span class="line">*.dispatchers=<span class="string">&#x27;(PROTOCOL=TCP) (SERVICE=dbnms)&#x27;</span></span><br><span class="line">*.open_cursors=<span class="number">300</span></span><br><span class="line"><span class="comment">#*.pga_aggregate_target=16106127360</span></span><br><span class="line">*.pga_aggregate_target=<span class="number">0</span></span><br><span class="line">*.processes=<span class="number">1500</span></span><br><span class="line">*.remote_login_passwordfile=<span class="string">&#x27;EXCLUSIVE&#x27;</span></span><br><span class="line">*.sessions=<span class="number">1655</span></span><br><span class="line"><span class="comment"># *.sga_target=64424509440</span></span><br><span class="line">*.sga_target=<span class="number">4294967296</span></span><br><span class="line">*.undo_tablespace=<span class="string">&#x27;UNDOTBS1&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="Optimizing"><a href="#Optimizing" class="headerlink" title="Optimizing"></a>Optimizing</h2><h4 id="Metric"><a href="#Metric" class="headerlink" title="Metric"></a>Metric</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;vsession:&#x27;</span><span class="operator">||</span><span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">||</span><span class="string">&#x27;&#x27;</span> <span class="keyword">as</span> moni <span class="keyword">from</span> v$session</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;maxsessions:&#x27;</span><span class="operator">||</span><span class="keyword">value</span><span class="operator">||</span><span class="string">&#x27;&#x27;</span> <span class="keyword">as</span> sessions <span class="keyword">from</span> v$<span class="keyword">parameter</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;sessions&#x27;</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;vprocess:&#x27;</span><span class="operator">||</span><span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">||</span><span class="string">&#x27;&#x27;</span> <span class="keyword">from</span> v$process</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;maxprocess:&#x27;</span><span class="operator">||</span><span class="keyword">value</span><span class="operator">||</span><span class="string">&#x27;&#x27;</span> <span class="keyword">from</span> v$<span class="keyword">parameter</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;processes&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$event_name;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$<span class="keyword">sql</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> p.spid, s.osuser, s.program ,p.<span class="operator">*</span> <span class="keyword">from</span> v$session s,v$process p <span class="keyword">where</span> s.paddr<span class="operator">=</span>p.addr   <span class="keyword">and</span> s.SID<span class="operator">=</span><span class="string">&#x27;8463&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">---eg:Buffer Busy Waits</span></span><br><span class="line"><span class="keyword">select</span>   sql_text   </span><br><span class="line"><span class="keyword">from</span>   v$<span class="keyword">sql</span> t1, v$session t2, v$session_wait   t3  </span><br><span class="line"><span class="keyword">where</span>   <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> t1.address<span class="operator">=</span>t2.sql_address   </span><br><span class="line"><span class="keyword">and</span> t1.hash_value<span class="operator">=</span>t2.sql_hash_value</span><br><span class="line"><span class="keyword">and</span> t2.sid<span class="operator">=</span>t3.sid   </span><br><span class="line"><span class="keyword">and</span> t3.event<span class="operator">=</span><span class="string">&#x27;buffer busy waits&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h4><ul>
<li>TOP IO SQL</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- - TOP IO SQL</span></span><br><span class="line"><span class="keyword">select</span> p.spid,s.sid,s.machine,s.program,q.disk_reads,q.sql_text</span><br><span class="line"><span class="keyword">from</span> v$process p,v$session s,v$<span class="keyword">sql</span> q</span><br><span class="line"><span class="keyword">where</span> p.addr<span class="operator">=</span>s.paddr <span class="keyword">and</span> s.sql_id<span class="operator">=</span>q.sql_id</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h4 id="INDEX"><a href="#INDEX" class="headerlink" title="INDEX"></a>INDEX</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">analyze <span class="keyword">table</span> TABLENAME compute statistics;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> sid,opname,target,sofar,totalwork,trunc(sofar<span class="operator">/</span>totalwork<span class="operator">*</span><span class="number">100</span>,<span class="number">2</span>)<span class="operator">||</span><span class="string">&#x27;%&#x27;</span> <span class="keyword">as</span> perwork</span><br><span class="line"><span class="keyword">from</span> v$session_longops <span class="keyword">where</span> sofar<span class="operator">!=</span>totalwork <span class="keyword">and</span> sid<span class="operator">=</span><span class="string">&#x27;1479&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 21:16 1	1479	Table Scan	SLVIEW.FLUX	6457	128417	5.02%</span></span><br><span class="line"><span class="comment">-- 1	1479	Table Scan	TEST.TABLE_A	14813	128417	11.53%</span></span><br></pre></td></tr></table></figure>
<h4 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;alter system kill session &#x27;&#x27;&#x27;</span><span class="operator">||</span><span class="string">&#x27;&#x27;</span><span class="operator">||</span>s.sid<span class="operator">||</span><span class="string">&#x27;,&#x27;</span><span class="operator">||</span>s.serial#<span class="operator">||</span><span class="string">&#x27;&#x27;&#x27;;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> v$locked_object lo,dba_objects ao,v$session s</span><br><span class="line"><span class="keyword">where</span> ao.object_id <span class="operator">=</span> lo.object_id <span class="keyword">and</span> lo.session_id <span class="operator">=</span> s.sid</span><br><span class="line"><span class="keyword">and</span> object_name <span class="operator">=</span> <span class="string">&#x27;TABLENAME&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="comment">/*+ rule */</span> s.username,decode(l.type,<span class="string">&#x27;TM&#x27;</span>,<span class="string">&#x27;TABLE LOCK&#x27;</span>,<span class="string">&#x27;TX&#x27;</span>,<span class="string">&#x27;ROW LOCK&#x27;</span>,<span class="keyword">NULL</span>) LOCK_LEVEL,</span><br><span class="line">o.owner,o.object_name,o.object_type,s.sid,s.serial#,s.terminal,s.machine,s.program,s.osuser,l.CTIME</span><br><span class="line"><span class="keyword">FROM</span> v$session s,v$lock l,dba_objects o <span class="keyword">WHERE</span> l.sid <span class="operator">=</span> s.sid <span class="keyword">AND</span> l.id1 <span class="operator">=</span> o.object_id(<span class="operator">+</span>)</span><br><span class="line"><span class="keyword">and</span> machine <span class="operator">=</span><span class="string">&#x27;HOST_NAME&#x27;</span></span><br><span class="line"><span class="keyword">and</span> owner<span class="operator">=</span><span class="string">&#x27;USER_NAME&#x27;</span>  </span><br><span class="line"><span class="keyword">and</span> object_name<span class="operator">=</span><span class="string">&#x27;TABLE_NAME&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> t2.username,  </span><br><span class="line">       t2.sid,  </span><br><span class="line">       t2.serial#,  </span><br><span class="line">       t3.object_name,  </span><br><span class="line">       t2.OSUSER,  </span><br><span class="line">       t2.MACHINE,  </span><br><span class="line">       t2.PROGRAM,  </span><br><span class="line">       t2.LOGON_TIME,  </span><br><span class="line">       t2.COMMAND,  </span><br><span class="line">       t2.LOCKWAIT,  </span><br><span class="line">       t2.SADDR,  </span><br><span class="line">       t2.PADDR,  </span><br><span class="line">       t2.TADDR,  </span><br><span class="line">       t2.SQL_ADDRESS,  </span><br><span class="line">       t1.LOCKED_MODE  </span><br><span class="line">  <span class="keyword">from</span> v$locked_object t1, v$session t2, dba_objects t3  </span><br><span class="line"><span class="keyword">where</span> t1.session_id <span class="operator">=</span> t2.sid  </span><br><span class="line">   <span class="keyword">and</span> t1.object_id <span class="operator">=</span> t3.object_id  </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> t2.logon_time;</span><br></pre></td></tr></table></figure>
<h4 id="Constraint"><a href="#Constraint" class="headerlink" title="Constraint"></a>Constraint</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.constraint_name, a.table_name, b.constraint_name</span><br><span class="line"><span class="keyword">from</span> user_constraints a, user_constraints b</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">a.constraint_type <span class="operator">=</span> <span class="string">&#x27;R&#x27;</span> <span class="comment">--外键</span></span><br><span class="line"><span class="comment">--and b.constraint_type = &#x27;P&#x27; --主键</span></span><br><span class="line"><span class="keyword">and</span> a.r_constraint_name <span class="operator">=</span> b.constraint_name</span><br><span class="line"><span class="keyword">and</span> a.constraint_name <span class="keyword">like</span> <span class="string">&#x27;%KEY_NAME%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 启用外键约束</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name enable <span class="keyword">constraint</span> constraint_name</span><br><span class="line"><span class="comment">-- 禁用外键约束</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name disable <span class="keyword">constraint</span> constraint_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;alter table &#x27;</span><span class="operator">||</span>table_name<span class="operator">||</span><span class="string">&#x27; enable constraint &#x27;</span><span class="operator">||</span>constraint_name<span class="operator">||</span><span class="string">&#x27;;&#x27;</span> <span class="keyword">from</span> user_constraints <span class="keyword">where</span> constraint_type<span class="operator">=</span><span class="string">&#x27;R&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;alter table &#x27;</span><span class="operator">||</span>table_name<span class="operator">||</span><span class="string">&#x27; disable constraint &#x27;</span><span class="operator">||</span>constraint_name<span class="operator">||</span><span class="string">&#x27;;&#x27;</span> <span class="keyword">from</span> user_constraints <span class="keyword">where</span> constraint_type<span class="operator">=</span><span class="string">&#x27;R&#x27;</span> ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="数据迁移"><a href="#数据迁移" class="headerlink" title="数据迁移"></a>数据迁移</h2><h4 id="数据泵"><a href="#数据泵" class="headerlink" title="数据泵"></a>数据泵</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 第一步：迁移准备，默认参数</span></span><br><span class="line">select * from dba_directories;</span><br><span class="line"></span><br><span class="line">create directory dir_dp  as <span class="string">&#x27;/oradata1/backdp&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 第二步:备份数据</span></span><br><span class="line">expdp <span class="string">&#x27;dbusername/******#@dbnms&#x27;</span> directory=DIR_DP dumpfile=LOG_P_20200930.dmp tables=USERLOGINFO:P_20200930 logfile=LOG_EXP_20200930.log &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment">## 第三步：Rename历史表</span></span><br><span class="line">rename USERLOGINFO to USERLOGINFO_20200910;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 第四步：重建表数据</span></span><br><span class="line">impdp <span class="string">&#x27;dbusername/******#@dbnms&#x27;</span> directory=DIR_DP dumpfile=LOG_P_20200930.dmp remap_tablespace=DATALIST:DATALOG logfile=LOG_IMP_20200930.log &amp;</span><br><span class="line"></span><br><span class="line">impdp <span class="string">&#x27;dbusername/******@@dbnms&#x27;</span> directory=DIR_DP dumpfile=LOG_P_20200831.dmp remap_tablespace=DATALIST:DATALOG logfile=LOG_IMP_20200831.log table_exists_action=append &amp;</span><br></pre></td></tr></table></figure>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li><strong>REMAP_TABLE feature was only introduced in 11G</strong></li>
</ul>
<h3 id="Expdp"><a href="#Expdp" class="headerlink" title="Expdp"></a>Expdp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># more LOG_EXP_20200930.log</span></span><br><span class="line">;;;</span><br><span class="line">Export: Release 10.2.0.4.0 - 64bit Production on Thursday, 10 September, 2020 23:25:16</span><br><span class="line"></span><br><span class="line">Copyright (c) 2003, 2007, Oracle.  All rights reserved.</span><br><span class="line">;;;</span><br><span class="line">Connected to: Oracle Database 10g Enterprise Edition Release 10.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Starting <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;SYS_EXPORT_TABLE_04&quot;</span>:  dbusername/********@dbnms directory=DIR_DP dumpfile=LOG_P_20200930.dmp tables=USERLOGINFO:P_20200930 logfile=LOG_EXP_20200930.log</span><br><span class="line">Estimate <span class="keyword">in</span> progress using BLOCKS method...</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/TABLE_DATA</span><br><span class="line">Total estimation using BLOCKS method: 4.994 GB</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/TABLE</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/INDEX/INDEX</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/INDEX/STATISTICS/INDEX_STATISTICS</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/STATISTICS/TABLE_STATISTICS</span><br><span class="line">. . exported <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;USERLOGINFO&quot;</span>:<span class="string">&quot;P_20200930&quot;</span>         4.335 GB 46060706 rows</span><br><span class="line">Master table <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;SYS_EXPORT_TABLE_04&quot;</span> successfully loaded/unloaded</span><br><span class="line">******************************************************************************</span><br><span class="line">Dump file <span class="built_in">set</span> <span class="keyword">for</span> SLVIEW.SYS_EXPORT_TABLE_04 is:</span><br><span class="line">  /oradata1/backdp/LOG_P_20200930.dmp</span><br><span class="line">Job <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;SYS_EXPORT_TABLE_04&quot;</span> successfully completed at 23:47:46</span><br></pre></td></tr></table></figure>
<h3 id="Impdp"><a href="#Impdp" class="headerlink" title="Impdp"></a>Impdp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ more LOG_IMP_20200930.log</span><br><span class="line">;;;</span><br><span class="line">Import: Release 10.2.0.4.0 - 64bit Production on Friday, 11 September, 2020 0:17:07</span><br><span class="line"></span><br><span class="line">Copyright (c) 2003, 2007, Oracle.  All rights reserved.</span><br><span class="line">;;;</span><br><span class="line">Connected to: Oracle Database 10g Enterprise Edition Release 10.2.0.4.0 - 64bit Production</span><br><span class="line">With the Partitioning, OLAP, Data Mining and Real Application Testing options</span><br><span class="line">Master table <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;SYS_IMPORT_FULL_01&quot;</span> successfully loaded/unloaded</span><br><span class="line">Starting <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;SYS_IMPORT_FULL_01&quot;</span>:  dbusername/********@dbnms directory=DIR_DP dumpfile=LOG_P_20200930.dmp remap_tablespace=DATALIST:DATALOG logfile=LOG_IMP_20200930.log</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/TABLE</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/TABLE_DATA</span><br><span class="line">. . imported <span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;USERLOGINFO&quot;</span>:<span class="string">&quot;P_20200930&quot;</span>         4.335 GB 46060706 rows</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/INDEX/INDEX</span><br><span class="line">ORA-31684: Object <span class="built_in">type</span> INDEX:<span class="string">&quot;SLVIEW&quot;</span>.<span class="string">&quot;IND_USERLOGINFO_LOGTIME&quot;</span> already exists</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/INDEX/STATISTICS/INDEX_STATISTICS</span><br><span class="line">ORA-39111: Dependent object <span class="built_in">type</span> INDEX_STATISTICS skipped, base object <span class="built_in">type</span> INDEX:<span class="string">&quot;DBUSER&quot;</span>.<span class="string">&quot;IND_USERLOGINFO_LOGTIME&quot;</span> already exists</span><br><span class="line">Processing object <span class="built_in">type</span> TABLE_EXPORT/TABLE/STATISTICS/TABLE_STATISTICS</span><br></pre></td></tr></table></figure>
<h4 id="Impdp参数"><a href="#Impdp参数" class="headerlink" title="Impdp参数"></a>Impdp参数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">REMAP_SCHEMA=scott:system   更改owner</span><br><span class="line">TABLESPACES=example   导入表空间</span><br><span class="line">TABLE_EXISTS_ACTION   追加数据</span><br><span class="line">table_exists_action   </span><br><span class="line">&#123;</span><br><span class="line">      skip 如果已存在表，则跳过并处理下一个对象；</span><br><span class="line">      append 为表增加数据；</span><br><span class="line">      truncate 截断表，然后为其增加新数据；</span><br><span class="line">      replace 删除已存在表，重新建表并追加数据</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="迁移过程"><a href="#迁移过程" class="headerlink" title="迁移过程"></a>迁移过程</h3><h4 id="监控利用率"><a href="#监控利用率" class="headerlink" title="监控利用率"></a>监控利用率</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SELECT a.tablespace_name <span class="string">&quot;表空间名&quot;</span>,</span><br><span class="line">round(total) <span class="string">&quot;表空间大小&quot;</span>,</span><br><span class="line">free <span class="string">&quot;表空间剩余大小&quot;</span>,</span><br><span class="line">round((total - free)) <span class="string">&quot;表空间使用大小&quot;</span>,</span><br><span class="line">round(total / (1024 * 1024 * 1024)) <span class="string">&quot;表空间大小(G)&quot;</span>,</span><br><span class="line">round(free / (1024 * 1024 * 1024)) <span class="string">&quot;表空间剩余大小(G)&quot;</span>,</span><br><span class="line">round((total - free) / (1024 * 1024 * 1024)) <span class="string">&quot;表空间使用大小(G)&quot;</span>,</span><br><span class="line">round((total - free) / total, 4) * 100 <span class="string">&quot;使用率 %&quot;</span></span><br><span class="line">FROM (SELECT tablespace_name, SUM(bytes) free</span><br><span class="line">FROM dba_free_space</span><br><span class="line">GROUP BY tablespace_name) a,</span><br><span class="line">(SELECT tablespace_name, SUM(bytes) total</span><br><span class="line">FROM dba_data_files</span><br><span class="line">GROUP BY tablespace_name) b</span><br><span class="line">WHERE a.tablespace_name = b.tablespace_name</span><br><span class="line">--and round((total - free) / total, 4) * 100 &gt; 80</span><br><span class="line">order by round((total - free) / total, 4) * 100 desc</span><br></pre></td></tr></table></figure>
<h4 id="调整表空间"><a href="#调整表空间" class="headerlink" title="调整表空间"></a>调整表空间</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ALTER TABLESPACE DATAFLUX ADD DATAFILE <span class="string">&#x27;/oradata6/dbnms/dataflux601.dbf&#x27;</span> SIZE  4096M;</span><br><span class="line"></span><br><span class="line">--1、查看表空间的名称及大小</span><br><span class="line">SELECT t.tablespace_name, round(SUM(bytes / (1024 * 1024)), 0) ts_size</span><br><span class="line">FROM dba_tablespaces t, dba_data_files d</span><br><span class="line">WHERE t.tablespace_name = d.tablespace_name</span><br><span class="line">GROUP BY t.tablespace_name;</span><br><span class="line">--2、查看表空间物理文件的名称及大小</span><br><span class="line">SELECT tablespace_name,</span><br><span class="line">file_id,</span><br><span class="line">file_name,</span><br><span class="line">round(bytes / (1024 * 1024), 0) total_space</span><br><span class="line">FROM dba_data_files</span><br><span class="line"><span class="built_in">where</span>  tablespace_name=<span class="string">&#x27;DATACFG&#x27;</span></span><br><span class="line">ORDER BY tablespace_name;</span><br><span class="line"></span><br><span class="line">select * from dba_data_files;</span><br><span class="line"></span><br><span class="line">--3、查看回滚段名称及大小</span><br><span class="line">SELECT segment_name,</span><br><span class="line">tablespace_name,</span><br><span class="line">r.status,</span><br><span class="line">(initial_extent / 1024) initialextent,</span><br><span class="line">(next_extent / 1024) nextextent,</span><br><span class="line">max_extents,</span><br><span class="line">v.curext curextent</span><br><span class="line">FROM dba_rollback_segs r, v<span class="variable">$rollstat</span> v</span><br><span class="line">WHERE r.segment_id = v.usn(+)</span><br><span class="line">ORDER BY segment_name;</span><br><span class="line">--4、查看控制文件</span><br><span class="line">SELECT NAME FROM v<span class="variable">$controlfile</span>;</span><br><span class="line">--5、查看日志文件</span><br><span class="line">SELECT MEMBER FROM v<span class="variable">$logfile</span>;</span><br><span class="line">--6、查看表空间的使用情况</span><br><span class="line">SELECT SUM(bytes) / (1024 * 1024) AS free_space, tablespace_name</span><br><span class="line">FROM dba_free_space</span><br><span class="line">GROUP BY tablespace_name;</span><br><span class="line">SELECT a.tablespace_name,</span><br><span class="line">a.bytes total,</span><br><span class="line">b.bytes used,</span><br><span class="line">c.bytes free,</span><br><span class="line">(b.bytes * 100) / a.bytes <span class="string">&quot;% USED &quot;</span>,</span><br><span class="line">(c.bytes * 100) / a.bytes <span class="string">&quot;% FREE &quot;</span></span><br><span class="line">FROM sys.sm<span class="variable">$ts_avail</span> a, sys.sm<span class="variable">$ts_used</span> b, sys.sm<span class="variable">$ts_free</span> c</span><br><span class="line">WHERE a.tablespace_name = b.tablespace_name</span><br><span class="line">AND a.tablespace_name = c.tablespace_name;</span><br><span class="line">--7、查看数据库库对象</span><br><span class="line">SELECT owner, object_type, status, COUNT(*) count<span class="comment">#</span></span><br><span class="line">FROM all_objects</span><br><span class="line">GROUP BY owner, object_type, status;</span><br><span class="line">--8、查看数据库的版本　</span><br><span class="line">SELECT version</span><br><span class="line">FROM product_component_version</span><br><span class="line">WHERE substr(product, 1, 6) = <span class="string">&#x27;Oracle&#x27;</span>;</span><br><span class="line">--9、查看数据库的创建日期和归档方式</span><br><span class="line">SELECT created, log_mode, log_mode FROM v<span class="variable">$database</span>;</span><br></pre></td></tr></table></figure>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/cd/B19306_01/server.102/b14237/initparams.htm#REFRN001">Oracle initparams</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/middleware/goldengate/index.html">Oracle GoldenGate Doc</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oracle.com/technetwork/cn/community/developer-day/3-goldengate-289794-zhs.pdf">Oracle GoldenGate 产品介绍</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/goldengate/c1230/gg-winux/GGSAU/GGSAU.pdf">Using Oracle GoldenGate Microservices Architecture</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://riboseyim.com/2018/11/21/Technology-Oracle-Ops/" data-id="ckwgm33p8013l7b1y6k7xuxch" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Database/" rel="tag">Database</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/" rel="tag">DevOps</a></li></ul>

    </footer>
  </div>

  
    <div class="article-entry" itemprop="articleBody">
      <p>
      欢迎扫码关注微信公众号获取最新动态，读者交流 QQ 群：338272982 。
      <br>
      </p>
      <p>
        <a href="https://riboseyim.com" title="微信公众号@睿哥杂货铺" rel="fancy-group" class="fancy-ctn fancybox">
          <img src="http://riboseyim-qiniu.riboseyim.com/ID_RiboseYim_201812.png" title="微信公众号@睿哥杂货铺">
        </a>
      </p>
    </div>
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =10
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
    <a href="/2018/11/21/Protocol-Route/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Protocol-Route
        
      </div>
    </a>
  
  
    <a href="/2018/10/03/Machine-Learning-Uber/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Uber 业务预测系统实践</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
       
      
      
  </div>
 
  
</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">1.</span> <span class="toc-text">摘要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSTALL"><span class="toc-number">2.</span> <span class="toc-text">INSTALL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Security"><span class="toc-number">2.0.1.</span> <span class="toc-text">Security</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Init-Params"><span class="toc-number">2.0.2.</span> <span class="toc-text">Init Params</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimizing"><span class="toc-number">3.</span> <span class="toc-text">Optimizing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Metric"><span class="toc-number">3.0.1.</span> <span class="toc-text">Metric</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Events"><span class="toc-number">3.0.2.</span> <span class="toc-text">Events</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL"><span class="toc-number">3.0.3.</span> <span class="toc-text">SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#INDEX"><span class="toc-number">3.0.4.</span> <span class="toc-text">INDEX</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lock"><span class="toc-number">3.0.5.</span> <span class="toc-text">Lock</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Constraint"><span class="toc-number">3.0.6.</span> <span class="toc-text">Constraint</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="toc-number">4.</span> <span class="toc-text">数据迁移</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B3%B5"><span class="toc-number">4.0.1.</span> <span class="toc-text">数据泵</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.0.2.</span> <span class="toc-text">注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Expdp"><span class="toc-number">4.1.</span> <span class="toc-text">Expdp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Impdp"><span class="toc-number">4.2.</span> <span class="toc-text">Impdp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Impdp%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.1.</span> <span class="toc-text">Impdp参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%81%E7%A7%BB%E8%BF%87%E7%A8%8B"><span class="toc-number">4.3.</span> <span class="toc-text">迁移过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E6%8E%A7%E5%88%A9%E7%94%A8%E7%8E%87"><span class="toc-number">4.3.1.</span> <span class="toc-text">监控利用率</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E6%95%B4%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="toc-number">4.3.2.</span> <span class="toc-text">调整表空间</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">5.</span> <span class="toc-text">参考文献</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
    
  
    <!--微信公众号二维码-->


  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
      <div  style="width:100%;margin:0 auto; padding:10px 0;text-align:center">
      &copy; 2008 - 2023 RiboseYim&nbsp;
      |&nbsp; Email:&nbsp; <a>riboseyim@gmail.com</a>
      |&nbsp; <a href="https://twitter.com/riboseyim" target="_blank" style="color:#939393;">Twitter</a>
      |&nbsp; <a href="https://github.com/riboseyim" target="_blank" style="color:#939393;">GitHub</a>
      |&nbsp; <a href="https://github.com/riboseyim/riboseyim.com.comment/issues" target="_blank"> 留言箱 Message Box</a>
    </div>
  </div>
  <div class="outer">
    <div  style="width:100%;margin:0 auto; padding:10px 0;text-align:center">
        主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank" style="color:#939393;font-size:80%">Hexo Cafe</a> |
       <a target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0" style="display:inline-block;text-decoration:none;color:#939393;font-size:80%">保持署名-非商业性使用-禁止演绎| License BY-NC-ND 4.0 </a> |
       <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258500076'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1258500076%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
  </div>
  </div>
</footer>

<script src="/jquery/jquery.min.js"></script>


    </div>
    <nav id="mobile-nav">
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/tags/DevOps" class="mobile-nav-link">DevOps</a>
  
    <a href="/tags/Machine-Learning" class="mobile-nav-link">机器学习</a>
  
    <a href="/tags/Economist" class="mobile-nav-link">经济学人</a>
  
    <a href="/tags/Policy-Law" class="mobile-nav-link">Policy&amp;Law</a>
  
    <a href="/charts" class="mobile-nav-link">图表</a>
  
    <a href="/2017/02/09/eBook" class="mobile-nav-link">电子书</a>
  
    <a href="/2016/05/31/AboutMe" class="mobile-nav-link">关于</a>
  
    <a href="https://riboseyim.com" class="mobile-nav-link">TechBlog</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
    
 


  
  





  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>